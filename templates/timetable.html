<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
  <!-- <link rel="stylesheet" href="{{ url_for('static',filename='timetable.css') }}"> -->
  <link rel="stylesheet" href="timetable.css">


  <style media="screen">
  </style>

  <meta charset="utf-8">
  <title></title>

</head>

<body>

  <div id="bg">

    <div id="title">
      <p>TIMETABLE
        <br>
        CONVERT</p>
    </div>


    <div id="titlechild">
      <p>Convert crs into timetable</p>
    </div>

    <button id="addsubject" type="button" name="button">Add subject</button>

    <form action="/show" method="post" enctype="multipart/form-data">
      <label id="chooselab" for="pdf-upload">Choose file</label>
      <input type="file" id="pdf-upload" name="file" />
      <input type="submit" id="upload" value="Upload">
    </form>

  </div>

  <input type="button" id="convert" value="Convert">

  <div id="change">
    <input id="wallpaper" type="file" name="" value="">
    <input id="opacity" type="number" step="0.1" min="0.1" max="1" value="1">
  </div>

  <button id="check" type="button" name="button">Check</button>
  <button id="sub" type="button" name="button" style="display:none;">Subject</button>
  <button id="custom" type="button" name="button" style="display:none;">Customize</button>



  <hr />
  <canvas id="canvas" style="position: absolute; top:1000px;height: 1000px;width: 100%;"></canvas>




  <div id="imagewallpaper" class="timetable">

    <div class="DAY">

      <div id="MONDAY">

        <p>MON</p>

      </div>

      <div id="TUESDAY">

        <p>TUE</p>

      </div>

      <div id="WEDNESDAY">
        <p>WED</p>
      </div>

      <div id="THURSDAY">
        <p>THUR</p>
      </div>

      <div id="FRIDAY">
        <p>FRI</p>
      </div>

      <div id="SATURDAY">
        <p>SAT</p>
      </div>

      <div id="SUNDAY">
        <p>SUN</p>
      </div>

    </div>


    <div id="MON">


    </div>

    <div id="TUE">

    </div>

    <div id="WED">

    </div>

    <div id="THUR">

    </div>

    <div id="FRI">

    </div>

    <div id="SAT">

    </div>

    <div id="SUN">

    </div>

  </div>

  <embed id="pdfview" type="application/pdf" style="display:none;" />


  <div id="ELEMENT" style="display:none;">

    <ul id="SUBJECTELEMENT">


    </ul>

  </div>

  <div id="CUSTOMIZE" style="display:none;">

    <ul id="CUSTOMIZEELEMENT">





    </ul>



  </div>

  <div class="addsub" id="addsub" style="visibility:hidden;">

    <p style="display:inline">Subject</p>
    <input id="subjectadd" type="text" name="" value=""style="width:120px;height:17px;margin-left:7px;padding:4px;">

    <br><br>

    <p style="margin-left:10px;display:inline">Color</p>
    <input id="coloradd" style="margin-left:10px;" type="color" name="" value="#F58080">

    <br><br>

    <p style="margin-left:15px;display:inline">Day</p>
    
    
    <select id="day" name="day" >
      <option value="SUN">SUN</option>
      <option value="MON">MON</option>
      <option value="TUE">TUE</option>
      <option value="WED">WED</option>
      <option value="THUR">THUR</option>
      <option value="FRI">FRI</option>
      <option value="SAT">SAT</option>
    </select>
  

    <br><br>

    <p style="display:inline";>Start time</p>

    <input id="time_start"style="display:inline;margin:5px;" type="time" name="" value="08:00">

    <br>

    <p style="display:inline;">End time</p>

    <input id="time_end" style="display:inline;margin:10px;" type="time" name="" value="09:00">

    <br>

<div style="position:absolute;bottom:0;margin:20px;right:5px;"class="">
  <button id="doneadd" style="display: inline;" type="button" name="button">Done</button>
  <button id="canceladd"style="display: inline;"type="button" name="button">Cancel</button>

</div>


  </div>

  <div class="edit" id="edit" style="visibility:hidden;">

    <p style="display:inline">Subject</p>
    <input id="subjectedit" type="text" name="" value=""style="width:120px;height:17px;margin-left:7px;padding:4px;">

    <br><br>

    <p style="margin-left:10px;display:inline">Color</p>
    <input id="coloredit" style="margin-left:10px;" type="color" name="" value="#F58080">

    <br><br>

    <p style="margin-left:15px;display:inline">Day</p>
    
    
    <select id="dayedit" name="day" >
      <option value="SUN">SUN</option>
      <option value="MON">MON</option>
      <option value="TUE">TUE</option>
      <option value="WED">WED</option>
      <option value="THUR">THUR</option>
      <option value="FRI">FRI</option>
      <option value="SAT">SAT</option>
    </select>

    <br><br>

    <p style="display:inline";>Start time</p>

    <input id="time_startedit"style="display:inline;margin:5px;" type="time" name="" value="08:00">

    <br>

    <p style="display:inline;">End time</p>

    <input id="time_endedit" style="display:inline;margin:10px;" type="time" name="" value="09:00">

    <br>

<div style="position:absolute;bottom:0;margin:20px;right:5px;"class="">
  <button id="doneedit" style="display: inline;" type="button" name="button">Done</button>
  <button id="canceledit"style="display: inline;"type="button" name="button">Cancel</button>
  <button id="delete"type="button" name="button">Delete</button>
</div>


  </div>



  <!-- <script type="text/javascript" src="{{ url_for('static', filename='timetable.js') }}"></script>  -->
  <script>

var editindex;

var index = [];
var subjecttimetable=[];
var daytimetable=[];
var time_starttimetable=[];
var time_endtimetable=[];
var colortimetable=[];
var toptimetable=[];
var heighttimetable=[];



function constructtimetable(){

  console.log(index.length);

  for(var i=0;i<index.length;i++){
   
   if(i > 0 && i < index.length-1 ){

    document.getElementById(i).remove();

   }
      
  }

  for(var i=0;i<index.length;i++){  

    create(toptimetable[i],heighttimetable[i],subjecttimetable[i],index[i],daytimetable[i],time_starttimetable[i],time_endtimetable[i],colortimetable[i]);
  }
}



document.getElementById('addsubject').addEventListener("click", function () {
  document.getElementById('addsub').style.visibility="visible";
});

document.getElementById("doneadd").addEventListener("click",myFunction);

document.getElementById('canceladd').addEventListener("click", function () {
  document.getElementById('addsub').style.visibility="hidden";
});

document.getElementById("doneedit").addEventListener("click",editsubject);

document.getElementById('canceledit').addEventListener("click", function () {

  document.getElementById('edit').style.visibility="hidden";
});

function enablingbutton(){

  var enable=false;

  if(document.getElementById('subjectadd').value==""){
    alert("Please fill the subject ");
  }
  else {
    enable=true;
  }

  return enable;
}

//  var info = {{ data| safe }};

document.getElementById("convert").addEventListener("click", function () {


    var info = JSON.stringify(info);

    var data = JSON.parse(info);

    for (var i = 0; i < data.length; i++) {

      var subject = data[i].SUBJECT;

      var daychoose = data[i].DAY;

      var time_start = data[i].START;

      var time_end = data[i].END;

      var format = data[i].FORMAT;

      var period = time_start - time_end;
      var width = period * 60;

      //starttime
      var fields = time_start.split('.');
      var hour = parseInt(fields[0]);

      if (format == "PM") {
        hour = hour + 12;
      }

      var minute = parseInt(fields[1]);
      var masa = (hour * 60) + minute;
      var button;

      //endtime
      var fields1 = time_end.split('.');
      var hour1 = parseInt(fields1[0]);

      if (format == "PM") {
        hour1 = hour1 + 12;
      }

      var minute1 = parseInt(fields1[1]);
      var masa1 = (hour1 * 60) + minute1;


      //period of subject
      var period = ((masa1 - masa) / 60) * 60;

      var periodtext = period.toString();

      //width of subject
      var height = periodtext + "px";


      //starttime aka top width
      var topcal = ((masa - 420) / 60) * 60;
      var toptext = topcal.toString();
      var top = toptext + "px";


      var combine = time_start + ' - ' + time_end;





      (function (x) {



        if (masa >= 420 && masa <= 1350 && masa1 >= 420 && masa1 <= 1350) {


          if (daychoose == "MON") {



            var div = document.createElement("div");
            div.style.position = "absolute";
            div.style.top = top;
            div.style.width = "100%";
            div.style.height = height;
            div.style.background = "blue";
            div.style.color = "white";
            div.innerHTML = subject;
            div.setAttribute("id", x);
            div.className = x;
            div.style.paddingTop = "8px";
            div.style.fontSize = "15px";
            div.onclick = function () {
              editindex = this.id;
              document.getElementById("edit").style.display = "inherit";
              var colorvalue = document.getElementById(editindex).style.background;

              console.log(colorvalue);

              function rgb2hex(rgb) {
                if (/^#[0-9A-F]{6}$/i.test(rgb)) return rgb;

                rgb = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
                function hex(x) {
                  return ("0" + parseInt(x).toString(16)).slice(-2);
                }
                return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);
              }
              var colorcode = rgb2hex(colorvalue);
              console.log(colorcode);

              document.getElementById("coloredit").value = colorcode;

              console.log(arr[this.id][0]);
              console.log(arr[this.id][1]);
              console.log(arr[this.id][2]);
              console.log(arr[this.id][3]);
            };

            var div2 = document.createElement("div");
            div2.style.position = "absolute";
            div2.style.top = top;
            div2.style.width = "100%";
            div2.style.height = "5px";
            div2.style.background = "transparent";
            div2.style.color = "white";
            div2.innerHTML = combine;
            div2.style.fontSize = "10px";
            div2.setAttribute("id", x);


            var div1 = document.createElement("LI");
            button = document.createElement("BUTTON");
            div1.style.top = "5px";
            div1.style.width = "90%";
            div1.style.height = "20px";
            div1.style.background = "grey";
            div1.style.color = "black";
            div1.innerHTML = subject;
            div1.setAttribute("id", x);
            div1.className = x;

            button.style.position = "absolute";
            button.style.left = "80%";
            button.style.width = "20%";
            button.style.height = "20px";
            button.setAttribute("id", x);
            button.id = x;
            button.value = x;

            button.onclick = function () {
              document.getElementById(this.id).remove();
              document.getElementById(this.id).remove();
              document.getElementById(this.id).remove();
            };
            button.innerHTML = "Remove";


            var color = document.createElement("INPUT");
            color.setAttribute("type", "color");
            color.style.position = "absolute";
            color.style.left = "71%";
            color.style.width = "4%";
            color.style.borderRadius = "10px";
            color.style.height = "24px";
            color.setAttribute("id", x);
            color.className = x;
            color.value = "#ffffff";
            color.addEventListener('change', function () {

              var length = document.getElementsByClassName(this.className).length;

              for (var i = 0; i < length; i++) {
                document.getElementsByClassName(this.className)[i].style.background = this.value;

              }

              document.querySelectorAll('input[type=text]').forEach(function (el) {
                el.style.background = "white";
              });

              document.querySelectorAll('input[type=color]').forEach(function (el) {

                el.value = "#ffffff";
                el.style.background = "white";
              });

            });

            var lab = document.createElement("LABEL");


            var text = document.createElement("INPUT");
            text.setAttribute("type", "text");
            text.style.position = "absolute";
            text.style.left = "35%";
            text.style.width = "100px";
            text.style.height = "20px";
            text.style.borderRadius = "10px";
            text.setAttribute("id", x);
            text.className = x;
            text.addEventListener('change', function () {


              lab.style.position = "absolute";
              lab.style.left = "20%";
              lab.style.width = "100px";
              lab.style.height = "20px";
              lab.style.color = "white";
              lab.setAttribute("id", x);
              lab.className = x;
              lab.innerHTML = this.value;

              document.getElementById(this.id).innerHTML = this.value;
              div1.appendChild(lab);


            });

            div1.appendChild(text);
            div1.appendChild(color);
            div1.appendChild(button);


            document.getElementById('MON').appendChild(div);
            document.getElementById('MON').appendChild(div2);
            document.getElementById('SUBJECTELEMENT').appendChild(div1);






          }
          else if (daychoose == "TUE") {

            var div = document.createElement("div");
            div.style.position = "absolute";
            div.style.top = top;
            div.style.width = "100%";
            div.style.height = height;
            div.style.background = "blue";
            div.style.color = "white";
            div.innerHTML = subject;
            div.setAttribute("id", x);
            div.className = x;
            div.style.paddingTop = "8px";
            div.style.fontSize = "15px";
            div.onclick = function () {
              editindex = this.id;
              document.getElementById("edit").style.display = "inherit";
              var colorvalue = document.getElementById(editindex).style.background;

              console.log(colorvalue);

              function rgb2hex(rgb) {
                if (/^#[0-9A-F]{6}$/i.test(rgb)) return rgb;

                rgb = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
                function hex(x) {
                  return ("0" + parseInt(x).toString(16)).slice(-2);
                }
                return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);
              }



              var colorcode = rgb2hex(colorvalue);


              console.log(colorcode);

              document.getElementById("coloredit").value = colorcode;
            };

            var div2 = document.createElement("div");
            div2.style.position = "absolute";
            div2.style.top = top;
            div2.style.width = "100%";
            div2.style.height = "5px";
            div2.style.background = "transparent";
            div2.style.color = "white";
            div2.innerHTML = combine;
            div2.style.fontSize = "10px";
            div2.setAttribute("id", x);


            var div1 = document.createElement("LI");
            button = document.createElement("BUTTON");
            div1.style.top = "5px";
            div1.style.width = "90%";
            div1.style.height = "20px";
            div1.style.background = "grey";
            div1.style.color = "black";
            div1.innerHTML = subject;
            div1.setAttribute("id", x);
            div1.className = x;

            button.style.position = "absolute";
            button.style.left = "80%";
            button.style.width = "20%";
            button.style.height = "20px";
            button.id = x;
            button.value = x;

            button.onclick = function () {
              document.getElementById(this.id).remove();
              document.getElementById(this.id).remove();
              document.getElementById(this.id).remove();
            };
            button.innerHTML = "Remove";


            var color = document.createElement("INPUT");
            color.setAttribute("type", "color");
            color.style.position = "absolute";
            color.style.left = "71%";
            color.style.width = "4%";
            color.style.borderRadius = "10px";
            color.style.height = "24px";
            color.setAttribute("id", x);
            color.className = x;
            color.value = "#ffffff";
            color.addEventListener('change', function () {

              var length = document.getElementsByClassName(this.className).length;

              for (var i = 0; i < length; i++) {
                document.getElementsByClassName(this.className)[i].style.background = this.value;

              }

              document.querySelectorAll('input[type=text]').forEach(function (el) {
                el.style.background = "white";
              });

              document.querySelectorAll('input[type=color]').forEach(function (el) {

                el.value = "#ffffff";
                el.style.background = "white";
              });

            });

            var lab = document.createElement("LABEL");


            var text = document.createElement("INPUT");
            text.setAttribute("type", "text");
            text.style.position = "absolute";
            text.style.left = "35%";
            text.style.width = "100px";
            text.style.height = "20px";
            text.style.borderRadius = "10px";
            text.setAttribute("id", x);
            text.className = x;
            text.addEventListener('change', function () {


              lab.style.position = "absolute";
              lab.style.left = "20%";
              lab.style.width = "100px";
              lab.style.height = "20px";
              lab.style.color = "white";
              lab.setAttribute("id", x);
              lab.className = x;
              lab.innerHTML = this.value;

              document.getElementById(this.id).innerHTML = this.value;
              div1.appendChild(lab);


            });

            div1.appendChild(text);
            div1.appendChild(color);
            div1.appendChild(button);


            document.getElementById('TUE').appendChild(div);
            document.getElementById('TUE').appendChild(div2);
            document.getElementById('SUBJECTELEMENT').appendChild(div1);



          }
          else if (daychoose == "WED") {

            var div = document.createElement("div");
            div.style.position = "absolute";
            div.style.top = top;
            div.style.width = "100%";
            div.style.height = height;
            div.style.background = "blue";
            div.style.color = "white";
            div.innerHTML = subject;
            div.setAttribute("id", x);
            div.className = x;
            div.style.paddingTop = "8px";
            div.style.fontSize = "15px";
            div.onclick = function () {
              editindex = this.id;
              document.getElementById("edit").style.display = "inherit";
              var colorvalue = document.getElementById(editindex).style.background;

              console.log(colorvalue);

              function rgb2hex(rgb) {
                if (/^#[0-9A-F]{6}$/i.test(rgb)) return rgb;

                rgb = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
                function hex(x) {
                  return ("0" + parseInt(x).toString(16)).slice(-2);
                }
                return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);
              }



              var colorcode = rgb2hex(colorvalue);


              console.log(colorcode);

              document.getElementById("coloredit").value = colorcode;
            };

            var div2 = document.createElement("div");
            div2.style.position = "absolute";
            div2.style.top = top;
            div2.style.width = "100%";
            div2.style.height = "5px";
            div2.style.background = "transparent";
            div2.style.color = "white";
            div2.innerHTML = combine;
            div2.style.fontSize = "10px";
            div2.setAttribute("id", x);


            var div1 = document.createElement("LI");
            button = document.createElement("BUTTON");
            div1.style.top = "5px";
            div1.style.width = "90%";
            div1.style.height = "20px";
            div1.style.background = "grey";
            div1.style.color = "black";
            div1.innerHTML = subject;
            div1.setAttribute("id", x);
            div1.className = x;

            button.style.position = "absolute";
            button.style.left = "80%";
            button.style.width = "20%";
            button.style.height = "20px";
            button.id = x;
            button.value = x;

            button.onclick = function () {
              document.getElementById(this.id).remove();
              document.getElementById(this.id).remove();
              document.getElementById(this.id).remove();
            };
            button.innerHTML = "Remove";


            var color = document.createElement("INPUT");
            color.setAttribute("type", "color");
            color.style.position = "absolute";
            color.style.left = "71%";
            color.style.width = "4%";
            color.style.borderRadius = "10px";
            color.style.height = "24px";
            color.setAttribute("id", x);
            color.className = x;
            color.value = "#ffffff";
            color.addEventListener('change', function () {

              var length = document.getElementsByClassName(this.className).length;

              for (var i = 0; i < length; i++) {
                document.getElementsByClassName(this.className)[i].style.background = this.value;

              }

              document.querySelectorAll('input[type=text]').forEach(function (el) {
                el.style.background = "white";
              });

              document.querySelectorAll('input[type=color]').forEach(function (el) {

                el.value = "#ffffff";
                el.style.background = "white";
              });

            });

            var lab = document.createElement("LABEL");


            var text = document.createElement("INPUT");
            text.setAttribute("type", "text");
            text.style.position = "absolute";
            text.style.left = "35%";
            text.style.width = "100px";
            text.style.height = "20px";
            text.style.borderRadius = "10px";
            text.setAttribute("id", x);
            text.className = x;
            text.addEventListener('change', function () {


              lab.style.position = "absolute";
              lab.style.left = "20%";
              lab.style.width = "100px";
              lab.style.height = "20px";
              lab.style.color = "white";
              lab.setAttribute("id", x);
              lab.className = x;
              lab.innerHTML = this.value;

              document.getElementById(this.id).innerHTML = this.value;
              div1.appendChild(lab);


            });

            div1.appendChild(text);
            div1.appendChild(color);
            div1.appendChild(button);


            document.getElementById('WED').appendChild(div);
            document.getElementById('WED').appendChild(div2);
            document.getElementById('SUBJECTELEMENT').appendChild(div1);




          }
          else if (daychoose == "THUR") {

            var div = document.createElement("div");
            div.style.position = "absolute";
            div.style.top = top;
            div.style.width = "100%";
            div.style.height = height;
            div.style.background = "blue";
            div.style.color = "white";
            div.innerHTML = subject;
            div.setAttribute("id", x);
            div.className = x;
            div.style.paddingTop = "8px";
            div.style.fontSize = "15px";
            div.onclick = function () {
              editindex = this.id;
              document.getElementById("edit").style.display = "inherit";
              var colorvalue = document.getElementById(editindex).style.background;

              console.log(colorvalue);

              function rgb2hex(rgb) {
                if (/^#[0-9A-F]{6}$/i.test(rgb)) return rgb;

                rgb = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
                function hex(x) {
                  return ("0" + parseInt(x).toString(16)).slice(-2);
                }
                return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);
              }



              var colorcode = rgb2hex(colorvalue);


              console.log(colorcode);

              document.getElementById("coloredit").value = colorcode;
            };

            var div2 = document.createElement("div");
            div2.style.position = "absolute";
            div2.style.top = top;
            div2.style.width = "100%";
            div2.style.height = "5px";
            div2.style.background = "transparent";
            div2.style.color = "white";
            div2.innerHTML = combine;
            div2.style.fontSize = "10px";
            div2.setAttribute("id", x);


            var div1 = document.createElement("LI");
            button = document.createElement("BUTTON");
            div1.style.top = "5px";
            div1.style.width = "90%";
            div1.style.height = "20px";
            div1.style.background = "grey";
            div1.style.color = "black";
            div1.innerHTML = subject;
            div1.setAttribute("id", x);
            div1.className = x;

            button.style.position = "absolute";
            button.style.left = "80%";
            button.style.width = "20%";
            button.style.height = "20px";
            button.id = x;
            button.value = x;

            button.onclick = function () {
              document.getElementById(this.id).remove();
              document.getElementById(this.id).remove();
              document.getElementById(this.id).remove();
            };
            button.innerHTML = "Remove";


            var color = document.createElement("INPUT");
            color.setAttribute("type", "color");
            color.style.position = "absolute";
            color.style.left = "71%";
            color.style.width = "4%";
            color.style.borderRadius = "10px";
            color.style.height = "24px";
            color.setAttribute("id", x);
            color.className = x;
            color.value = "#ffffff";
            color.addEventListener('change', function () {

              var length = document.getElementsByClassName(this.className).length;

              for (var i = 0; i < length; i++) {
                document.getElementsByClassName(this.className)[i].style.background = this.value;

              }

              document.querySelectorAll('input[type=text]').forEach(function (el) {
                el.style.background = "white";
              });

              document.querySelectorAll('input[type=color]').forEach(function (el) {

                el.value = "#ffffff";
                el.style.background = "white";
              });

            });

            var lab = document.createElement("LABEL");


            var text = document.createElement("INPUT");
            text.setAttribute("type", "text");
            text.style.position = "absolute";
            text.style.left = "35%";
            text.style.width = "100px";
            text.style.height = "20px";
            text.style.borderRadius = "10px";
            text.setAttribute("id", x);
            text.className = x;
            text.addEventListener('change', function () {


              lab.style.position = "absolute";
              lab.style.left = "20%";
              lab.style.width = "100px";
              lab.style.height = "20px";
              lab.style.color = "white";
              lab.setAttribute("id", x);
              lab.className = x;
              lab.innerHTML = this.value;

              document.getElementById(this.id).innerHTML = this.value;
              div1.appendChild(lab);


            });

            div1.appendChild(text);
            div1.appendChild(color);
            div1.appendChild(button);


            document.getElementById('THUR').appendChild(div);
            document.getElementById('THUR').appendChild(div2);
            document.getElementById('SUBJECTELEMENT').appendChild(div1);




          }
          else if (daychoose == "FRI") {

            var div = document.createElement("div");
            div.style.position = "absolute";
            div.style.top = top;
            div.style.width = "100%";
            div.style.height = height;
            div.style.background = "blue";
            div.style.color = "white";
            div.innerHTML = subject;
            div.setAttribute("id", x);
            div.className = x;
            div.style.paddingTop = "8px";
            div.style.fontSize = "15px";
            div.onclick = function () {
              editindex = this.id;
              document.getElementById("edit").style.display = "inherit";
              var colorvalue = document.getElementById(editindex).style.background;

              console.log(colorvalue);

              function rgb2hex(rgb) {
                if (/^#[0-9A-F]{6}$/i.test(rgb)) return rgb;

                rgb = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
                function hex(x) {
                  return ("0" + parseInt(x).toString(16)).slice(-2);
                }
                return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);
              }



              var colorcode = rgb2hex(colorvalue);


              console.log(colorcode);

              document.getElementById("coloredit").value = colorcode;
            };

            var div2 = document.createElement("div");
            div2.style.position = "absolute";
            div2.style.top = top;
            div2.style.width = "100%";
            div2.style.height = "5px";
            div2.style.background = "transparent";
            div2.style.color = "white";
            div2.innerHTML = combine;
            div2.style.fontSize = "10px";
            div2.setAttribute("id", x);


            var div1 = document.createElement("LI");
            button = document.createElement("BUTTON");
            div1.style.top = "5px";
            div1.style.width = "90%";
            div1.style.height = "20px";
            div1.style.background = "grey";
            div1.style.color = "black";
            div1.innerHTML = subject;
            div1.setAttribute("id", x);
            div1.className = x;

            button.style.position = "absolute";
            button.style.left = "80%";
            button.style.width = "20%";
            button.style.height = "20px";
            button.id = x;
            button.value = x;

            button.onclick = function () {
              document.getElementById(this.id).remove();
              document.getElementById(this.id).remove();
              document.getElementById(this.id).remove();
            };
            button.innerHTML = "Remove";


            var color = document.createElement("INPUT");
            color.setAttribute("type", "color");
            color.style.position = "absolute";
            color.style.left = "71%";
            color.style.width = "4%";
            color.style.borderRadius = "10px";
            color.style.height = "24px";
            color.setAttribute("id", x);
            color.className = x;
            color.value = "#ffffff";
            color.addEventListener('change', function () {

              var length = document.getElementsByClassName(this.className).length;

              for (var i = 0; i < length; i++) {
                document.getElementsByClassName(this.className)[i].style.background = this.value;

              }

              document.querySelectorAll('input[type=text]').forEach(function (el) {
                el.style.background = "white";
              });

              document.querySelectorAll('input[type=color]').forEach(function (el) {

                el.value = "#ffffff";
                el.style.background = "white";
              });

            });

            var lab = document.createElement("LABEL");


            var text = document.createElement("INPUT");
            text.setAttribute("type", "text");
            text.style.position = "absolute";
            text.style.left = "35%";
            text.style.width = "100px";
            text.style.height = "20px";
            text.style.borderRadius = "10px";
            text.setAttribute("id", x);
            text.className = x;
            text.addEventListener('change', function () {


              lab.style.position = "absolute";
              lab.style.left = "20%";
              lab.style.width = "100px";
              lab.style.height = "20px";
              lab.style.color = "white";
              lab.setAttribute("id", x);
              lab.className = x;
              lab.innerHTML = this.value;

              document.getElementById(this.id).innerHTML = this.value;
              div1.appendChild(lab);


            });

            div1.appendChild(text);
            div1.appendChild(color);
            div1.appendChild(button);


            document.getElementById('FRI').appendChild(div);
            document.getElementById('FRI').appendChild(div2);
            document.getElementById('SUBJECTELEMENT').appendChild(div1);




          }
          else if (daychoose == "SAT") {

            var div = document.createElement("div");
            div.style.position = "absolute";
            div.style.top = top;
            div.style.width = "100%";
            div.style.height = height;
            div.style.background = "blue";
            div.style.color = "white";
            div.innerHTML = subject;
            div.setAttribute("id", x);
            div.className = x;
            div.style.paddingTop = "8px";
            div.style.fontSize = "15px";
            div.onclick = function () {
              editindex = this.id;
              document.getElementById("edit").style.display = "inherit";
              var colorvalue = document.getElementById(editindex).style.background;

              console.log(colorvalue);

              function rgb2hex(rgb) {
                if (/^#[0-9A-F]{6}$/i.test(rgb)) return rgb;

                rgb = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
                function hex(x) {
                  return ("0" + parseInt(x).toString(16)).slice(-2);
                }
                return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);
              }



              var colorcode = rgb2hex(colorvalue);


              console.log(colorcode);

              document.getElementById("coloredit").value = colorcode;
            };

            var div2 = document.createElement("div");
            div2.style.position = "absolute";
            div2.style.top = top;
            div2.style.width = "100%";
            div2.style.height = "5px";
            div2.style.background = "transparent";
            div2.style.color = "white";
            div2.innerHTML = combine;
            div2.style.fontSize = "10px";
            div2.setAttribute("id", x);


            var div1 = document.createElement("LI");
            button = document.createElement("BUTTON");
            div1.style.top = "5px";
            div1.style.width = "90%";
            div1.style.height = "20px";
            div1.style.background = "grey";
            div1.style.color = "black";
            div1.innerHTML = subject;
            div1.setAttribute("id", x);
            div1.className = x;

            button.style.position = "absolute";
            button.style.left = "80%";
            button.style.width = "20%";
            button.style.height = "20px";
            button.id = x;
            button.value = x;

            button.onclick = function () {
              document.getElementById(this.id).remove();
              document.getElementById(this.id).remove();
              document.getElementById(this.id).remove();
            };
            button.innerHTML = "Remove";


            var color = document.createElement("INPUT");
            color.setAttribute("type", "color");
            color.style.position = "absolute";
            color.style.left = "71%";
            color.style.width = "4%";
            color.style.borderRadius = "10px";
            color.style.height = "24px";
            color.setAttribute("id", x);
            color.className = x;
            color.value = "#ffffff";
            color.addEventListener('change', function () {

              var length = document.getElementsByClassName(this.className).length;

              for (var i = 0; i < length; i++) {
                document.getElementsByClassName(this.className)[i].style.background = this.value;

              }

              document.querySelectorAll('input[type=text]').forEach(function (el) {
                el.style.background = "white";
              });

              document.querySelectorAll('input[type=color]').forEach(function (el) {

                el.value = "#ffffff";
                el.style.background = "white";
              });

            });

            var lab = document.createElement("LABEL");


            var text = document.createElement("INPUT");
            text.setAttribute("type", "text");
            text.style.position = "absolute";
            text.style.left = "35%";
            text.style.width = "100px";
            text.style.height = "20px";
            text.style.borderRadius = "10px";
            text.setAttribute("id", x);
            text.className = x;
            text.addEventListener('change', function () {


              lab.style.position = "absolute";
              lab.style.left = "20%";
              lab.style.width = "100px";
              lab.style.height = "20px";
              lab.style.color = "white";
              lab.setAttribute("id", x);
              lab.className = x;
              lab.innerHTML = this.value;

              document.getElementById(this.id).innerHTML = this.value;
              div1.appendChild(lab);


            });

            div1.appendChild(text);
            div1.appendChild(color);
            div1.appendChild(button);


            document.getElementById('SAT').appendChild(div);
            document.getElementById('SAT').appendChild(div2);
            document.getElementById('SUBJECTELEMENT').appendChild(div1);




          }
          else if (daychoose == "SUN") {

            var div = document.createElement("div");
            div.style.position = "absolute";
            div.style.top = top;
            div.style.width = "100%";
            div.style.height = height;
            div.style.background = "blue";
            div.style.color = "white";
            div.innerHTML = subject;
            div.setAttribute("id", x);
            div.className = x;
            div.style.paddingTop = "8px";
            div.style.fontSize = "15px";
            div.onclick = function () {
              editindex = this.id;
              document.getElementById("edit").style.display = "inherit";
              var colorvalue = document.getElementById(editindex).style.background;

              console.log(colorvalue);

              function rgb2hex(rgb) {
                if (/^#[0-9A-F]{6}$/i.test(rgb)) return rgb;

                rgb = rgb.match(/^rgb\((\d+),\s*(\d+),\s*(\d+)\)$/);
                function hex(x) {
                  return ("0" + parseInt(x).toString(16)).slice(-2);
                }
                return "#" + hex(rgb[1]) + hex(rgb[2]) + hex(rgb[3]);
              }



              var colorcode = rgb2hex(colorvalue);


              console.log(colorcode);

              document.getElementById("coloredit").value = colorcode;
            };

            var div2 = document.createElement("div");
            div2.style.position = "absolute";
            div2.style.top = top;
            div2.style.width = "100%";
            div2.style.height = "5px";
            div2.style.background = "transparent";
            div2.style.color = "white";
            div2.innerHTML = combine;
            div2.style.fontSize = "10px";
            div2.setAttribute("id", x);


            var div1 = document.createElement("LI");
            button = document.createElement("BUTTON");
            div1.style.top = "5px";
            div1.style.width = "90%";
            div1.style.height = "20px";
            div1.style.background = "grey";
            div1.style.color = "black";
            div1.innerHTML = subject;
            div1.setAttribute("id", x);
            div1.className = x;

            button.style.position = "absolute";
            button.style.left = "80%";
            button.style.width = "20%";
            button.style.height = "20px";
            button.id = x;
            button.value = x;

            button.onclick = function () {
              document.getElementById(this.id).remove();
              document.getElementById(this.id).remove();
              document.getElementById(this.id).remove();
            };
            button.innerHTML = "Remove";


            var color = document.createElement("INPUT");
            color.setAttribute("type", "color");
            color.style.position = "absolute";
            color.style.left = "71%";
            color.style.width = "4%";
            color.style.borderRadius = "10px";
            color.style.height = "24px";
            color.setAttribute("id", x);
            color.className = x;
            color.value = "#ffffff";
            color.addEventListener('change', function () {

              var length = document.getElementsByClassName(this.className).length;

              for (var i = 0; i < length; i++) {
                document.getElementsByClassName(this.className)[i].style.background = this.value;

              }

              document.querySelectorAll('input[type=text]').forEach(function (el) {
                el.style.background = "white";
              });

              document.querySelectorAll('input[type=color]').forEach(function (el) {

                el.value = "#ffffff";
                el.style.background = "white";
              });

            });

            var lab = document.createElement("LABEL");


            var text = document.createElement("INPUT");
            text.setAttribute("type", "text");
            text.style.position = "absolute";
            text.style.left = "35%";
            text.style.width = "100px";
            text.style.height = "20px";
            text.style.borderRadius = "10px";
            text.setAttribute("id", x);
            text.className = x;
            text.addEventListener('change', function () {


              lab.style.position = "absolute";
              lab.style.left = "20%";
              lab.style.width = "100px";
              lab.style.height = "20px";
              lab.style.color = "white";
              lab.setAttribute("id", x);
              lab.className = x;
              lab.innerHTML = this.value;

              document.getElementById(this.id).innerHTML = this.value;
              div1.appendChild(lab);


            });

            div1.appendChild(text);
            div1.appendChild(color);
            div1.appendChild(button);


            document.getElementById('SUN').appendChild(div);
            document.getElementById('SUN').appendChild(div2);
            document.getElementById('SUBJECTELEMENT').appendChild(div1);

          }

          var j = document.getElementById('SUBJECTELEMENT').childElementCount;
          var c = document.getElementById('SUBJECTELEMENT').childNodes;
          var d = document.querySelectorAll('input[type=color]');
          var f = document.getElementById('SUBJECTELEMENT').querySelectorAll('input[type=text]');




          var letters = '0123456789ABCDEF';
          var color = '#';

          for (var z = 0; z < 6; z++) {
            color += letters[Math.floor(Math.random() * 16)];
          }

          var w = 1;

          while (w <= j) {

            var str = c[w].textContent;
            var str1 = c[j].textContent;

            str = str.replace("Remove", "");
            str1 = str1.replace("Remove", "");

            if (str == str1) {
              c[j].className = c[w].className;
              d[w - 1].value = d[j - 1].value;

              var length = document.getElementsByClassName(c[w].className).length;

              for (var i = 0; i < length; i++) {
                document.getElementsByClassName(c[w].className)[i].style.background = c[j].style.background;

              }


              c[w].id;

              if (daychoose == "MON") {
                document.getElementById(c[w].id).className = c[w].className;
                d[w - 1].className = c[w].className;
                f[w - 1].className = c[w].className;
                f[w - 1].style.background = "white";
                document.getElementsByClassName(c[j].className[0])[0].style.background = c[w].style.background;


              } else if (daychoose == "TUE") {
                document.getElementById(c[w].id).className = c[w].className;
                d[w - 1].className = c[w].className;
                f[w - 1].className = c[w].className;
                f[w - 1].style.background = "white";
                document.getElementsByClassName(c[j].className[0])[0].style.background = c[w].style.background;


              } else if (daychoose == "WED") {
                document.getElementById(c[w].id).className = c[w].className;
                d[w - 1].className = c[w].className;
                f[w - 1].className = c[w].className;
                f[w - 1].style.background = "white";
                document.getElementsByClassName(c[j].className[0])[0].style.background = c[w].style.background;


              } else if (daychoose == "THUR") {
                document.getElementById(c[w].id).className = c[w].className;
                d[w - 1].className = c[w].className;
                f[w - 1].className = c[w].className;
                f[w - 1].style.background = "white";
                document.getElementsByClassName(c[j].className[0])[0].style.background = c[w].style.background;


              } else if (daychoose == "FRI") {
                document.getElementById(c[w].id).className = c[w].className;
                d[w - 1].className = c[w].className;
                f[w - 1].className = c[w].className;
                f[w - 1].style.background = "white";
                document.getElementsByClassName(c[j].className[0])[0].style.background = c[w].style.background;


              } else if (daychoose == "SAT") {
                document.getElementById(c[w].id).className = c[w].className;
                d[w - 1].className = c[w].className;
                f[w - 1].className = c[w].className;
                f[w - 1].style.background = "white";
                document.getElementsByClassName(c[j].className[0])[0].style.background = c[w].style.background;


              } else if (daychoose == "SUN") {
                document.getElementById(c[w].id).className = c[j].className;
                d[w - 1].className = c[w].className;
                f[w - 1].className = c[w].className;
                f[w - 1].style.background = "white";
                document.getElementsByClassName(c[j].className[0])[0].style.background = c[w].style.background;


              }
            }
            else {

              c[j].style.background = color;
              if (daychoose == "MON") {

                document.getElementById(c[j].id).style.background = color;

              } else if (daychoose == "TUE") {

                document.getElementById(c[j].id).style.background = color;

              } else if (daychoose == "WED") {

                document.getElementById(c[j].id).style.background = color;

              } else if (daychoose == "THUR") {

                document.getElementById(c[j].id).style.background = color;

              } else if (daychoose == "FRI") {

                document.getElementById(c[j].id).style.background = color;

              } else if (daychoose == "SAT") {

                document.getElementById(c[j].id).style.background = color;

              } else if (daychoose == "SUN") {

                document.getElementById(c[j].id).style.background = color;

              }
            }

            w++;

          }

          console.log(document.getElementById(x).textContent);

        }
      }).call(this, i)
    }

    console.log(arr);

 });

document.getElementById("custom").addEventListener("click", function () {

    document.getElementById('ELEMENT').style.visibility = "hidden";
    document.getElementById('pdfview').style.visibility = "hidden";
    document.getElementById('SUBJECTELEMENT').style.visibility = "hidden";
    document.getElementById('CUSTOMIZEELEMENT').style.visibility = "visible";
    document.getElementById('CUSTOMIZE').style.visibility = "visible";
    var x = document.getElementById('SUBJECTELEMENT').childElementCount;
    var c = document.getElementById('SUBJECTELEMENT').childNodes;

    var last = c[x].className;
    var last = parseInt(last);
    var y = 1;
  })

document.getElementById("check").addEventListener("click", function () {
   document.getElementById('ELEMENT').style.visibility = "hidden";
   document.getElementById('pdfview').style.visibility = "visible";
   document.getElementById('SUBJECTELEMENT').style.visibility = "hidden";
   document.getElementById('CUSTOMIZE').style.visibility = "hidden";
   document.getElementById('CUSTOMIZEELEMENT').style.visibility = "hidden";

 });

document.getElementById("sub").addEventListener("click", function () {
   document.getElementById('ELEMENT').style.visibility = "visible";
   document.getElementById('pdfview').style.visibility = "hidden";
   document.getElementById('SUBJECTELEMENT').style.visibility = "visible";
   document.getElementById('CUSTOMIZE').style.visibility = "hidden";
   document.getElementById('CUSTOMIZEELEMENT').style.visibility = "hidden";
 });

document.getElementById("opacity").addEventListener("change", function () {
   var mon = document.getElementById('MON');
   var tue = document.getElementById('TUE');
   var wed = document.getElementById('WED');
   var thur = document.getElementById('THUR');
   var fri = document.getElementById('FRI');
   var sun = document.getElementById('SUN');
   var sat = document.getElementById('SAT');

   mon.style.opacity = this.value;
   tue.style.opacity = this.value;
   wed.style.opacity = this.value;
   thur.style.opacity = this.value;
   fri.style.opacity = this.value;
   sun.style.opacity = this.value;
   sat.style.opacity = this.value;
 });

document.getElementById('wallpaper').addEventListener('change', readURL, true);
  function readURL() {
   var file = document.getElementById("wallpaper").files[0];
   var reader = new FileReader();
   reader.onloadend = function () {
     document.getElementById('imagewallpaper').style.backgroundImage = "url(" + reader.result + ")";
   }
   if (file) {
     reader.readAsDataURL(file);
   } else {
   }
 }

 //ADD SUBJECT
 function create(top,height,subject,x,daychoose,time_start,time_end,color){

    var div = document.createElement("div");
    div.style.position = "absolute";
    div.style.top = top;
    div.style.width = "100%";
    div.style.height = height;
    div.style.background = color;
    div.style.color = "white";
    div.setAttribute("id", x);
    div.className = x;
  
    div.onclick = function () {

      editindex = this.id;
      var classindex = this.className;
      console.log(editindex);
      document.getElementById("edit").style.visibility = "visible";

      document.getElementById('delete').addEventListener("click", function (){
         deleteRow(classindex);
         document.getElementById('edit').style.visibility="hidden";
      });


      var coloredit=document.getElementById('coloredit').value;

      coloredit = document.getElementById(editindex).style.background;

      for(var i=0;i<index.length;i++){

        if(editindex==index[i]){
           document.getElementById('subjectedit').value = subjecttimetable[i];

          document.getElementById('dayedit');

          day.options[day.selectedIndex].value = daytimetable[i];
     
          document.getElementById('time_startedit').value = time_starttimetable[i];
     
           document.getElementById('time_endedit').value = time_endtimetable[i];
     
           document.getElementById('coloredit').value = colortimetable[i];
        }
      }

      

      console.log(document.getElementById(editindex).textContent);
    };

    var textforsub = document.createElement("H1") ;    
    var textsubject = document.createTextNode(subject);
    textforsub.style.position="absolute";
    textforsub.style.top="5px";
    textforsub.style.fontSize = "15px";
    textforsub.style.marginLeft="3px";
    textforsub.style.marginTop="7px";
    textforsub.style.fontFamily=" Calibri";

    textforsub.appendChild(textsubject);
    div.appendChild(textforsub);

   /* var div2 = document.createElement("div");
    div2.style.position = "absolute";
    div2.style.top = top;
    div2.style.width = "100%";
    div2.style.height = height;
    div2.style.background = "transparent";
    div2.style.color = "white";
    div2.style.fontSize = "10px";
    div2.setAttribute("id", x);*/

    var ts = document.createElement("H1") ;    
    var hs = document.createTextNode(time_start.toString());
    ts.appendChild(hs);
    ts.style.position="absolute";
    ts.style.top = 0;
    ts.style.color = "white";
    ts.style.fontSize = "10px";
    ts.style.marginTop="-0.05px";
    ts.style.margin="3px";

    var te = document.createElement("H1") ;    
    var he = document.createTextNode(time_end.toString());
    te.appendChild(he);
    te.style.position="absolute";
    te.style.bottom = 0;
    te.style.right = 0;
    te.style.color = "white";
    te.style.fontSize = "10px";
    te.style.margin="3px";

    div.appendChild(ts);  
    div.appendChild(te);  
    


    document.getElementById(daychoose).appendChild(div);
    //document.getElementById(daychoose).appendChild(div2);
   


  }

 function editnumberindex(x) {
   var editindex = x;
 }

function myFunction(){
var enable;

enable=enablingbutton();

if(enable==false){
   ;
 }
else{
   var x = index.length;

   console.log(x);

   var subject = document.getElementById('subjectadd').value;

   var day = document.getElementById('day');

  var daychoose = day.options[day.selectedIndex].value;

   var time_start = document.getElementById('time_start').value;

   var time_end = document.getElementById('time_end').value;

   var color = document.getElementById('coloradd').value;

   var period = time_start - time_end;
   var width = period * 60;


   //starttime
   var fields = time_start.split(':');
   var hour = parseInt(fields[0]);
   var minute = parseInt(fields[1]);
   var masa = (hour * 60) + minute;

   //endtime
   var fields1 = time_end.split(':');
   var hour1 = parseInt(fields1[0]);
   var minute1 = parseInt(fields1[1]);
   var masa1 = (hour1 * 60) + minute1;

   //period of subject
   var period = ((masa1 - masa) / 60) * 60;

   var periodtext = period.toString();

   //width of subject
   var height = periodtext + "px";


   //starttime aka top width
   var topcal = ((masa - 420) / 60) * 60;
   var toptext = topcal.toString();
   var top = toptext + "px";

   var combine = time_start + ' - ' + time_end;

   if (masa >= 420 && masa <= 1200 && masa1 >= 420 && masa1 <= 1200) {

       index.push(x);
       subjecttimetable.push(subject);
       daytimetable.push(daychoose);
       time_starttimetable.push(time_start);
       time_endtimetable.push(time_end);
       colortimetable.push(color);
       toptimetable.push(top);
       heighttimetable.push(height);

       x++;   

   }

   document.getElementById('addsub').style.visibility="hidden";
   constructtimetable();
 }

 
 }

 function deleteRow(x) {

    /*var elements = document.getElementsByClassName(x);
    while(elements.length > 0){
        elements[0].parentNode.removeChild(elements[0]);
    }*/

   document.getElementById(x).remove();
 

 }

function editsubject(){
  var enable;

  enable=enablingbutton();

  if(enable==false){
     ;
   }
  else{
     var x = 0;

     var subject = document.getElementById('subjectedit').value;

     var day = document.getElementById('day');

     var daychoose = day.options[day.selectedIndex].value;

     var time_start = document.getElementById('time_start').value;

     var time_end = document.getElementById('time_end').value;

     var color = document.getElementById('coloredit').value;

     var period = time_start - time_end;
     var width = period * 60;


     //starttime
     var fields = time_start.split(':');
     var hour = parseInt(fields[0]);
     var minute = parseInt(fields[1]);
     var masa = (hour * 60) + minute;

     //endtime
     var fields1 = time_end.split(':');
     var hour1 = parseInt(fields1[0]);
     var minute1 = parseInt(fields1[1]);
     var masa1 = (hour1 * 60) + minute1;

     //period of subject
     var period = ((masa1 - masa) / 60) * 60;

     var periodtext = period.toString();

     //width of subject
     var height = periodtext + "px";


     //starttime aka top width
     var topcal = ((masa - 420) / 60) * 60;
     var toptext = topcal.toString();
     var top = toptext + "px";

     var combine = time_start + ' - ' + time_end;

     if (masa >= 420 && masa <= 1200 && masa1 >= 420 && masa1 <= 1200) {

       if (document.getElementById("monchooseedit").checked == true) {

         var daychoose="MON";

         create(top,height,subject,x,daychoose,combine,color)

         x++;


       }
       
}



}
}




</script>






</html>
